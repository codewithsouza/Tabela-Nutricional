<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>Rótulo Interativo</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
</head>

<body>

    <div class="preview-wrapper">
        <div class="rotulo-container" id="rotulo">
            <div class="card">
                <div class="top-bar">
                    
                </div>
                <div class="titulo-prato">
                    <input type="text" value="Escondidinho">
                </div>
                <div class="subtitulo">
                    <input type="text" value="Carne seca">
                </div>
                <span class="industria-brasileira" style="font-size: 14px; display: block; text-align: center; margin-bottom: 4px;">Indústria Brasileira</span>
                <div class="info-geral">
                    <input type="text" value="Peso líquido: 600g">
                    <input type="text" value="Preparo: Micro-ondas 12 a 14 min">
                    <input type="text" value="Forno: 25 a 30 min">
                </div>
            </div>

            <div class="card">
                <div style="font-weight: bold; font-size: 9px;">
                    <input type="text" value="INFORMAÇÃO NUTRICIONAL">
                </div>
                <div style="font-size: 9px; margin-bottom: 2px;">
                    <input type="text" value="Porção por embalagem: 2">
                    <input type="text" value="Porção: 300g (meia unidade)">
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Componente</th>
                            <th>100 g</th>
                            <th>300 g</th>
                            <th>%VD*</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Valor Energético (Kcal)</td>
                            <td><input type="text" value="179"></td>
                            <td><input type="text" value="537"></td>
                            <td><input type="text" value="27"></td>
                        </tr>
                        <tr>
                            <td>Carboidratos (g)</td>
                            <td><input type="text" value="12"></td>
                            <td><input type="text" value="35"></td>
                            <td><input type="text" value="12"></td>
                        </tr>
                        <tr>
                            <td>Açúcares totais (g)</td>
                            <td><input type="text" value="1,9"></td>
                            <td><input type="text" value="5,7"></td>
                            <td><input type="text" value=""></td>
                        </tr>
                        <tr>
                            <td>Açúcares adicionados (g)</td>
                            <td><input type="text" value="0,6"></td>
                            <td><input type="text" value="1,8"></td>
                            <td><input type="text" value="4"></td>
                        </tr>
                        <tr>
                            <td>Proteínas (g)</td>
                            <td><input type="text" value="13"></td>
                            <td><input type="text" value="39"></td>
                            <td><input type="text" value="77"></td>
                        </tr>
                        <tr>
                            <td>Gorduras Totais (g)</td>
                            <td><input type="text" value="8,6"></td>
                            <td><input type="text" value="26"></td>
                            <td><input type="text" value="40"></td>
                        </tr>
                        <tr>
                            <td>Gorduras Saturadas (g)</td>
                            <td><input type="text" value="4,2"></td>
                            <td><input type="text" value="13"></td>
                            <td><input type="text" value="63"></td>
                        </tr>
                        <tr>
                            <td>Gorduras Trans (g)</td>
                            <td><input type="text" value="0"></td>
                            <td><input type="text" value="0"></td>
                            <td><input type="text" value="0"></td>
                        </tr>
                        <tr>
                            <td>Fibras alimentares (g)</td>
                            <td><input type="text" value="0,9"></td>
                            <td><input type="text" value="2,7"></td>
                            <td><input type="text" value="11"></td>
                        </tr>
                        <tr>
                            <td>Sódio (mg)</td>
                            <td><input type="text" value="615"></td>
                            <td><input type="text" value="1845"></td>
                            <td><input type="text" value="92"></td>
                        </tr>
                    </tbody>
                </table>
                <div class="info-extra">
                    <input type="text" value="*Porcentagem de valores diários fornecidos pela porção.">
                </div>
            </div>

            <div class="card">
                <div class="ingredientes">
                    <strong>Ingredientes:</strong><br>
                    <input type="text" value="Purê de mandioca, carne seca, parmesão, alho, especiarias e sal."><br><br>
                    <input type="text" value="Não contém glúten." style="font-weight:bold; width: 100%; background: transparent; border: none; color: #333; font-size: 12px;"><br><br>
                    <strong>ALÉRGICOS:</strong><br>
                    <input type="text" value="Contém derivados de leite, de soja. Pode conter trigo e ovos.">
                </div>
                <div class="validade-sodio" style="display: flex; align-items: center; gap: 10px;">
                    <div class="validade">
                        <input type="text" value="Validade: 11/2021">
                    </div>
                    <span class="selo-alto-sodio" id="seloAltoSodio">
                        <div class="sodio-selo-wrapper pequeno" style="height:22px;min-width:60px;border-width:1.5px;">
                            <span class="sodio-lupa" style="width:18px;height:22px;border-right:1.5px solid #000;display:flex;align-items:center;justify-content:center;">
                                <svg width="14" height="14" viewBox="0 0 22 22">
                                    <circle cx="10" cy="10" r="7" stroke="black" stroke-width="2" fill="white"/>
                                    <rect x="15" y="15" width="5" height="2" rx="1" fill="black" transform="rotate(45 15 15)"/>
                                    <circle cx="10" cy="10" r="3" fill="white" stroke="black"/>
                                </svg>
                            </span>
                            <span class="sodio-altoem" style="font-size:11px;height:22px;padding:0 4px 0 2px;font-family:Arial,sans-serif;font-weight:bold;color:#000;display:flex;align-items:center;">ALTO EM</span>
                            <span class="sodio-sodio" style="font-size:12px;height:22px;padding:0 8px;font-family:Arial,sans-serif;font-weight:bold;color:#fff;background:#000;display:flex;align-items:center;">SÓDIO</span>
                        </div>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <button onclick="baixarRotulo()">Baixar como PNG</button>

    <div class="toggle-sodio">
        <input type="checkbox" id="toggleSodio" checked>
        <label for="toggleSodio">Exibir selo ALTO EM SÓDIO</label>
    </div>

    <script>
    // Controle do selo ALTO EM SÓDIO
    document.addEventListener('DOMContentLoaded', function() {
        const checkbox = document.getElementById('toggleSodio');
        const selo = document.getElementById('seloAltoSodio');
        checkbox.addEventListener('change', function() {
            selo.style.display = this.checked ? 'inline-flex' : 'none';
        });
        selo.style.display = checkbox.checked ? 'inline-flex' : 'none';
    });
    function baixarRotulo() {
        const original = document.getElementById('rotulo');
        const clone = original.cloneNode(true);
        clone.classList.add('light-mode');

        // Oculta o selo no PNG se o checkbox estiver desmarcado
        const showSodio = document.getElementById('toggleSodio').checked;
        const cloneSelo = clone.querySelector('#seloAltoSodio');
        if (cloneSelo) cloneSelo.style.display = showSodio ? 'inline-flex' : 'none';
       
        clone.querySelectorAll('input[type="text"]').forEach(input => {
            const span = document.createElement('span');
            const style = window.getComputedStyle(input);
            span.innerText = input.value;
            span.style.fontFamily = style.fontFamily;
            span.style.fontSize = style.fontSize;
            span.style.fontWeight = style.fontWeight;
            span.style.color = "#fff"; 
            span.style.textAlign = style.textAlign;
            span.style.display = "inline-block";

            if (input.parentElement.classList.contains('titulo-prato')) {
                span.style.fontSize = '64px';
                span.style.marginBottom = '2px';
                span.style.fontFamily = "'Great Vibes', cursive";
                span.style.color = '#fff';
                span.style.textShadow = '2px 2px 6px #000, 0 0 2px #fff';
            } else if (input.parentElement.classList.contains('subtitulo')) {
                span.style.fontSize = '32px';
                span.style.fontFamily = "'Great Vibes', cursive";
                span.style.color = '#fff';
                span.style.textShadow = '2px 2px 6px #000, 0 0 2px #fff';
            }

            input.parentNode.replaceChild(span, input);
        });

    
        clone.querySelectorAll('textarea').forEach(textarea => {
            const span = document.createElement('span');
            const style = window.getComputedStyle(textarea);
            span.innerHTML = textarea.value.replace(/\n/g, '<br>');
            span.style.fontFamily = style.fontFamily;
            span.style.fontSize = style.fontSize;
            span.style.fontWeight = style.fontWeight;
            span.style.color = "#fff";
            span.style.textAlign = style.textAlign;
            span.style.display = "inline-block";
            textarea.parentNode.replaceChild(span, textarea);
        });

        
        clone.querySelectorAll('td, th').forEach(cell => {
            cell.style.color = '#fff';
            cell.style.fontWeight = 'bold';
        });

        const wrapper = document.createElement('div');
        wrapper.style.position = 'fixed';
        wrapper.style.top = '-10000px';
        wrapper.style.left = '0';
        wrapper.style.backgroundColor = 'transparent';
        wrapper.appendChild(clone);
        document.body.appendChild(wrapper);

        document.fonts.ready.then(() => {
            html2canvas(clone, {
                backgroundColor: null, 
                scale: 2,
                scrollY: 0,
                scrollX: 0,
                useCORS: true
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'rotulo.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                document.body.removeChild(wrapper);
            });
        });
    }
</script>
</body>
</html>